

<!DOCTYPE html>
<html class="no-js" lang="en">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title> SSL | Scylla Docs
    </title>
    <meta name="description" content="Scylla is an Apache Cassandra-compatible NoSQL data store that can handle 1 million transactions per second on a single server." />
    <link
      rel="icon"
      href="../../_static/img/favicon.ico"
      type="image/x-icon"
    />
    <link
      rel="icon"
      href="../../_static/img/favicon-32x32.png"
      sizes="32x32"
    />
    <link
      rel="icon"
      href="../../_static/img/favicon-228x228.png"
      sizes="192x192"
    />
    <link
      rel="apple-touch-icon"
      href="../../_static/img/favicon-228x228.png"
    />
    <meta
      name="msapplication-TileImage"
      href="../../_static/img/favicon-228x228.png"
    />
    <link rel="canonical" href="https://docs.scylladb.com/" />
    <link rel="author" href="mailto:info@scylladb.com" />
  <!-- connect to domain of font files -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

  <!-- optionally increase loading priority -->
  <link
    rel="preload"
    as="style"
    href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap"
  />

  <!-- async CSS -->
  <link
    rel="stylesheet"
    media="print"
    onload="this.onload=null;this.removeAttribute('media');"
    href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap"
  />

  <!-- no-JS fallback -->
  <noscript>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap"
    />
  </noscript>
  <link
    rel="stylesheet"
    href="../../_static/css/main.css"
    type="text/css"
  />
  <link
    rel="stylesheet"
    href="../../_static/pygments.css"
    type="text/css"
  /> <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />

  <script
    type="text/javascript"
    id="documentation_options"
    data-url_root="../../"
    src="../../_static/documentation_options.js"
  ></script>
  <script
    type="text/javascript"
    src="../../_static/js/runtime.bundle.js"
  ></script>
  <script
    type="text/javascript"
    src="../../_static/js/main.bundle.js"
  ></script> <script src="../../_static/underscore.js"></script> <script src="../../_static/doctools.js"></script> <script src="../../_static/language_data.js"></script> <script src="../../_static/clipboard.min.js"></script> <script src="../../_static/copybutton.js"></script>

    <!-- Google Tag Manager -->
    <script>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "GTM-T8P2JP");
    </script>
    <!-- End Google Tag Manager -->
    <!-- Marketo -->
    <script type="text/javascript">
      (function () {
        var didInit = false;
        function initMunchkin() {
          if (didInit === false) {
            didInit = true;
            Munchkin.init("791-QBF-350");
          }
        }
        var s = document.createElement("script");
        s.type = "text/javascript";
        s.async = true;
        s.src = "//munchkin.marketo.net/munchkin.js";
        s.onreadystatechange = function () {
          if (this.readyState == "complete" || this.readyState == "loaded") {
            initMunchkin();
          }
        };
        s.onload = initMunchkin;
        document.getElementsByTagName("head")[0].appendChild(s);
      })();
    </script>
    <!-- End Marketo -->
    <!-- Expertrec -->
    <script>
      var id = "e2077224-9ccf-11e9-a0c9-0242ac130002";
      var ci_search = document.createElement("script");
      ci_search.type = "text/javascript";
      ci_search.async = true;
      ci_search.src = "https://cse.expertrec.com/api/js/ci_common.js?id=" + id;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(ci_search, s);
    </script>
    <!-- End Expertrec -->

    <!-- Font Awesome -->
    <script
      src="https://kit.fontawesome.com/b1870adf6a.js"
      crossorigin="anonymous"
    ></script>
    <!-- End Font Awesome -->
  </head>
  
  <body>
     <header class="header">
  <div class="header-logo">
    <a class="header-logo__img" href="https://scylladb.com/">
      <img
        src="../../_static/img/logo-scylla-docs.svg"
        alt="Scylla Documentation Logo"
      />
    </a>
    <span class="header-logo__bar"></span>
    <a class="header-logo__text" href="https://docs.scylladb.com/">
      Documentation
    </a>
  </div>
  <div class="header-navigation">
    <ul
      class="dropdown menu scylla-dropdown scylla-dropdown--header"
      data-dropdown-menu
    >
      <li class="scylla-dropdown__item">
        <a href="#" class="scylla-dropdown__title"
          >Server <i class="chevron scylla-icon scylla-icon--triangle-down"></i
        ></a>
        <ul class="menu scylla-dropdown__content">
          <li>
            <a href="https://docs.scylladb.com/"
              ><i class="scylla-icon scylla-icon--about-us"></i>Scylla Open
              Source</a
            >
          </li>
          <li>
            <a href="https://docs.scylladb.com/"
              ><i class="scylla-icon scylla-icon--enterprise"></i>Scylla
              Enterprise</a
            >
          </li>
          <li>
            <a
              href="https://scylla.docs.scylladb.com/master/alternator/alternator.html"
            >
              <i class="scylla-icon scylla-icon--overview"></i>Scylla
              Alternator</a
            >
          </li>
        </ul>
      </li>
      <li class="scylla-dropdown__item">
        <a href="#" class="scylla-dropdown__title"
          >Cloud <i class="chevron scylla-icon scylla-icon--triangle-down"></i
        ></a>
        <ul class="menu scylla-dropdown__content">
          <li>
            <a href="https://cloud.scylladb.com/">
              <i class="scylla-icon scylla-icon--cloud"></i>Scylla Cloud</a
            >
          </li>
          <li>
            <a href="https://docs.scylladb.com/scylla-cloud/">
              <i class="scylla-icon scylla-icon--cloud-docs"></i>Scylla Cloud
              Docs</a
            >
          </li>
        </ul>
      </li>
      <li class="scylla-dropdown__item">
        <a href="#" class="scylla-dropdown__title"
          >Tools <i class="chevron scylla-icon scylla-icon--triangle-down"></i
        ></a>
        <ul class="menu scylla-dropdown__content">
          <li>
            <a href="https://manager.docs.scylladb.com/">
              <i class="scylla-icon scylla-icon--manager"></i>Scylla Manager</a
            >
          </li>
          <li>
            <a href="https://monitoring.docs.scylladb.com/">
              <i class="scylla-icon scylla-icon--monitoring"></i>Scylla
              Monitoring Stack</a
            >
          </li>
          <li>
            <a href="https://operator.docs.scylladb.com/">
              <i class="scylla-icon scylla-icon--operator"></i>Scylla Operator
            </a>
          </li>
        </ul>
      </li>
      <li class="scylla-dropdown__item">
        <a href="#" class="scylla-dropdown__title"
          >Drivers <i class="chevron scylla-icon scylla-icon--triangle-down"></i
        ></a>
        <ul class="menu scylla-dropdown__content">
          <li>
            <a
              href="https://docs.scylladb.com/using-scylla/drivers/cql-drivers/"
            >
              <i class="scylla-icon scylla-icon--nsql-guides"></i>CQL Drivers
            </a>
          </li>
          <li>
            <a
              href="https://docs.scylladb.com/using-scylla/drivers/dynamo-drivers/"
            >
              <i class="scylla-icon scylla-icon--overview"></i>DynamoDB Drivers
            </a>
          </li>
        </ul>
      </li>
    </ul>
    <div class="header-button">
      <a href="https://www.scylladb.com/download/" class="button">Download</a>
    </div>
  </div>
  <div class="header-search-box">
    <div class="search-box">
      <ci-search></ci-search>
    </div>
  </div>
  <div class="side-nav-toggle" data-toggle="side-nav">
  <div class="side-nav-toggle__button">
    <img src="../../_static/img/menu.svg" alt="Menu" />
  </div>
</div>
</header>
    <section class="layout ">
      <div class="content large-order-2">
         

        <div class="pre-content">
          <div class="pre-content__left"><div class="breadcrumbs">
  <span class="bread__item">
    <a
      href="https://java-driver.docs.scylladb.com"
      class="bread__highlight"
    >
      <i class="fas fa-home"></i> Scylla Java Driver</a
    ></span
  >
  
  <span class="bread__item"
    ><a href="../index.html">Manual</a></span
  >
  
  <span class="bread__item bread__item--last">SSL</span>
</div></div>
          <div class="pre-content__right"><ul
  class="dropdown menu scylla-dropdown scylla-dropdown--contribute"
  data-dropdown-menu
>
  <li class="scylla-dropdown__item">
    <a class="scylla-dropdown__title" href="#">
      <div class="scylla-dropdown__title--body">
        <i class="icon fa fa-github" aria-hidden="true"></i>
        Contribute
      </div>
      <i class="chevron scylla-icon scylla-icon--chevron-right"></i>
    </a>
    <ul class="menu scylla-dropdown__content">
      <li>
        <a
          href="https://github.com/scylladb/java-driver/issues/new?title=Issue in page SSL&&body=I%20would%20like%20to%20report%20an%20issue%20in%20page%20https://java-driver.docs.scylladb.com/scylla-3.10.2.x/manual/ssl/index%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix"
          target="_blank"
          >Report a doc issue
          <i class="icon fa fa-external-link" aria-hidden="true"></i
        ></a>
      </li>
      
      <li>
             
        <a
          href="https://github.com/scylladb/java-driver/edit/scylla-3.10.2.x/docs/source/manual/ssl/index.md"
          target="_blank"
          >Edit this page
          <i class="icon fa fa-external-link" aria-hidden="true"></i
        ></a>
      </li>
      
      <li>
        <a href="https://docs.scylladb.com/contribute/" target="_blank"
          >Learn how to contribute
          <i class="icon fa fa-external-link" aria-hidden="true"></i
        ></a>
      </li>
    </ul>
  </li>
</ul></div>
        </div>
         <div class="section" id="ssl">
<h1>SSL<a class="headerlink" href="#ssl" title="Permalink to this headline">¶</a></h1>
<p>You can secure traffic between the driver and Cassandra with SSL. There
are two aspects to that:</p>
<ul class="simple">
<li><p><strong>client-to-node encryption</strong>, where the traffic is encrypted, and the
client verifies the identity of the Cassandra nodes it connects to;</p></li>
<li><p>optionally, <strong>client certificate authentication</strong>, where Cassandra
nodes also verify the identity of the client.</p></li>
</ul>
<p>This section describes the driver-side configuration; it assumes that
you’ve already configured SSL in Cassandra:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://docs.datastax.com/en/cassandra/2.0/cassandra/security/secureSSLClientToNode_t.html">the Cassandra documentation</a>
covers a basic approach with self-signed certificates, which is fine
for development and tests.</p></li>
<li><p><a class="reference external" href="http://thelastpickle.com/blog/2015/09/30/hardening-cassandra-step-by-step-part-1-server-to-server.html">this blog post</a>
details a more advanced solution based on a Certificate Authority
(CA).</p></li>
</ul>
<div class="section" id="preparing-the-certificates">
<h2>Preparing the certificates<a class="headerlink" href="#preparing-the-certificates" title="Permalink to this headline">¶</a></h2>
<div class="section" id="client-truststore">
<h3>Client truststore<a class="headerlink" href="#client-truststore" title="Permalink to this headline">¶</a></h3>
<p>This is required for client-to-node encryption.</p>
<p>If you’re using self-signed certificates, you need to export the public
part of each node’s certificate from that node’s keystore:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">keytool</span> <span class="o">-</span><span class="n">export</span> <span class="o">-</span><span class="n">alias</span> <span class="n">cassandra</span> <span class="o">-</span><span class="n">file</span> <span class="n">cassandranode0</span><span class="o">.</span><span class="n">cer</span> <span class="o">-</span><span class="n">keystore</span> <span class="o">.</span><span class="n">keystore</span>
</pre></div>
</div>
<p>Then add all public certificates to the client truststore:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">keytool</span> <span class="o">-</span><span class="kn">import</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">trustcacerts</span> <span class="o">-</span><span class="n">alias</span> <span class="o">&lt;</span><span class="n">cassandra_node0</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">file</span> <span class="n">cassandranode0</span><span class="o">.</span><span class="n">cer</span> <span class="o">-</span><span class="n">keystore</span> <span class="n">client</span><span class="o">.</span><span class="n">truststore</span>
<span class="n">keytool</span> <span class="o">-</span><span class="kn">import</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">trustcacerts</span> <span class="o">-</span><span class="n">alias</span> <span class="o">&lt;</span><span class="n">cassandra_node1</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">file</span> <span class="n">cassandranode1</span><span class="o">.</span><span class="n">cer</span> <span class="o">-</span><span class="n">keystore</span> <span class="n">client</span><span class="o">.</span><span class="n">truststore</span>
<span class="o">...</span>
</pre></div>
</div>
<p>If you’re using a Certificate Authority, the client truststore only
needs to contain the CA’s certificate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">keytool</span> <span class="o">-</span><span class="kn">import</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">trustcacerts</span> <span class="o">-</span><span class="n">alias</span> <span class="n">CARoot</span> <span class="o">-</span><span class="n">file</span> <span class="n">ca</span><span class="o">.</span><span class="n">cer</span> <span class="o">-</span><span class="n">keystore</span> <span class="n">client</span><span class="o">.</span><span class="n">truststore</span>
</pre></div>
</div>
</div>
<div class="section" id="client-keystore">
<h3>Client keystore<a class="headerlink" href="#client-keystore" title="Permalink to this headline">¶</a></h3>
<p>If you also intend to use client certificate authentication, generate
the public and private key pair for the client:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">keytool</span> <span class="o">-</span><span class="n">genkey</span> <span class="o">-</span><span class="n">keyalg</span> <span class="n">RSA</span> <span class="o">-</span><span class="n">alias</span> <span class="n">client</span> <span class="o">-</span><span class="n">keystore</span> <span class="n">client</span><span class="o">.</span><span class="n">keystore</span>
</pre></div>
</div>
<p>If you’re using self-signed certificates, extract the public part of the
client certificate, and import it in the truststore of each Cassandra
node:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">keytool</span> <span class="o">-</span><span class="n">export</span> <span class="o">-</span><span class="n">alias</span> <span class="n">client</span> <span class="o">-</span><span class="n">file</span> <span class="n">client</span><span class="o">.</span><span class="n">cer</span> <span class="o">-</span><span class="n">keystore</span> <span class="n">client</span><span class="o">.</span><span class="n">keystore</span>
<span class="n">keytool</span> <span class="o">-</span><span class="kn">import</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">trustcacerts</span> <span class="o">-</span><span class="n">alias</span> <span class="n">client</span> <span class="o">-</span><span class="n">file</span> <span class="n">client</span><span class="o">.</span><span class="n">cer</span> <span class="o">-</span><span class="n">keystore</span> <span class="n">server</span><span class="o">.</span><span class="n">truststore</span>
</pre></div>
</div>
<p>If you’re using a CA, sign the client certificate with it (see the blog
post linked at the top of this page). Then the nodes’ truststores only
need to contain the CA’s certificate (which should already be the case
if you’ve followed the steps for inter-node encryption).</p>
</div>
</div>
<div class="section" id="driver-configuration">
<h2>Driver configuration<a class="headerlink" href="#driver-configuration" title="Permalink to this headline">¶</a></h2>
<p>The base class to configure SSL is <a class="reference external" href="https://java-driver.docs.scylladb.com/stable/api/com/datastax/driver/core/RemoteEndpointAwareSSLOptions.html">RemoteEndpointAwareSSLOptions</a>. It’s very generic, but
you don’t necessarily need to deal with it directly: the default
instance, or the provided subclasses, might be enough for your needs.</p>
<div class="section" id="jsse-property-based">
<h3>JSSE, Property-based<a class="headerlink" href="#jsse-property-based" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">withSSL()</span></code> gives you a basic JSSE configuration:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">Cluster</span> <span class="n">cluster</span> <span class="o">=</span> <span class="n">Cluster</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
  <span class="o">.</span><span class="na">addContactPoint</span><span class="o">(</span><span class="s">&quot;127.0.0.1&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="na">withSSL</span><span class="o">()</span>
  <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</pre></div>
</div>
<p>You can then use
<a class="reference external" href="http://docs.oracle.com/javase/6/docs/technotes/guides/security/jsse/JSSERefGuide.html#Customization">JSSE system properties</a>
for specific details, like keystore locations and passwords:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">Djavax</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">trustStore</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">client</span><span class="o">.</span><span class="n">truststore</span>
<span class="o">-</span><span class="n">Djavax</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">trustStorePassword</span><span class="o">=</span><span class="n">password123</span>
<span class="c1"># If you&#39;re using client authentication:</span>
<span class="o">-</span><span class="n">Djavax</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">keyStore</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">client</span><span class="o">.</span><span class="n">keystore</span>
<span class="o">-</span><span class="n">Djavax</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">keyStorePassword</span><span class="o">=</span><span class="n">password123</span>
</pre></div>
</div>
</div>
<div class="section" id="jsse-programmatic">
<h3>JSSE, programmatic<a class="headerlink" href="#jsse-programmatic" title="Permalink to this headline">¶</a></h3>
<p>If you need more control than what system properties allow, you can
configure SSL programmatically with <a class="reference external" href="https://java-driver.docs.scylladb.com/stable/api/com/datastax/driver/core/RemoteEndpointAwareJdkSSLOptions.html">RemoteEndpointAwareJdkSSLOptions</a>:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">SSLContext</span> <span class="n">sslContext</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">// create and configure SSL context</span>

<span class="n">RemoteEndpointAwareJdkSSLOptions</span> <span class="n">sslOptions</span> <span class="o">=</span> <span class="n">RemoteEndpointAwareJdkSSLOptions</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
  <span class="o">.</span><span class="na">withSSLContext</span><span class="o">(</span><span class="n">context</span><span class="o">)</span>
  <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="n">Cluster</span> <span class="n">cluster</span> <span class="o">=</span> <span class="n">Cluster</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
  <span class="o">.</span><span class="na">addContactPoint</span><span class="o">(</span><span class="s">&quot;127.0.0.1&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="na">withSSL</span><span class="o">(</span><span class="n">sslOptions</span><span class="o">)</span>
  <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</pre></div>
</div>
<p>Note that you can also extend the class and override
<a class="reference external" href="https://java-driver.docs.scylladb.com/stable/api/com/datastax/driver/core/RemoteEndpointAwareJdkSSLOptions.html#newSSLEngine-io.netty.channel.socket.SocketChannel-java.net.InetSocketAddress-">newSSLEngine(SocketChannel,InetSocketAddress)</a> if you need specific
configuration on the <code class="docutils literal notranslate"><span class="pre">SSLEngine</span></code>.  For example, to enable hostname verification:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">SSLContext</span> <span class="n">sslContext</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">// create and configure SSL context</span>

<span class="n">RemoteEndpointAwareJdkSSLOptions</span> <span class="n">sslOptions</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RemoteEndpointAwareJdkSSLOptions</span><span class="o">(</span><span class="n">sslContext</span><span class="o">,</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="n">SSLEngine</span> <span class="nf">newSSLEngine</span><span class="o">(</span><span class="n">SocketChannel</span> <span class="n">channel</span><span class="o">,</span> <span class="n">InetSocketAddress</span> <span class="n">remoteEndpoint</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">SSLEngine</span> <span class="n">engine</span> <span class="o">=</span> <span class="kd">super</span><span class="o">.</span><span class="na">newSSLEngine</span><span class="o">(</span><span class="n">channel</span><span class="o">,</span> <span class="n">remoteEndpoint</span><span class="o">);</span>
        <span class="n">SSLParameters</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="na">getSSLParameters</span><span class="o">();</span>
        <span class="c1">// HTTPS endpoint identification includes hostname verification against certificate&#39;s common name.</span>
        <span class="c1">// This API is only available for JDK7+.</span>
        <span class="n">parameters</span><span class="o">.</span><span class="na">setEndpointIdentificationAlgorithm</span><span class="o">(</span><span class="s">&quot;HTTPS&quot;</span><span class="o">);</span>
        <span class="n">engine</span><span class="o">.</span><span class="na">setSSLParameters</span><span class="o">(</span><span class="n">parameters</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">engine</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">};</span>

<span class="n">Cluster</span> <span class="n">cluster</span> <span class="o">=</span> <span class="n">Cluster</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
  <span class="o">.</span><span class="na">addContactPoint</span><span class="o">(</span><span class="s">&quot;127.0.0.1&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="na">withSSL</span><span class="o">(</span><span class="n">sslOptions</span><span class="o">)</span>
  <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</pre></div>
</div>
</div>
<div class="section" id="netty">
<h3>Netty<a class="headerlink" href="#netty" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://java-driver.docs.scylladb.com/stable/api/com/datastax/driver/core/RemoteEndpointAwareNettySSLOptions.html">RemoteEndpointAwareNettySSLOptions</a> allows you to use Netty’s <code class="docutils literal notranslate"><span class="pre">SslContext</span></code> instead of
the JDK directly. The advantage is that Netty can use OpenSSL directly,
which provides better performance and generates less garbage.  A disadvantage of
using the OpenSSL provider is that it requires platform-specific dependencies,
unlike the JDK provider.</p>
<div class="section" id="converting-your-client-certificates-for-openssl">
<h4>Converting your client certificates for OpenSSL<a class="headerlink" href="#converting-your-client-certificates-for-openssl" title="Permalink to this headline">¶</a></h4>
<p>OpenSSL doesn’t use keystores, so if you use client authentication and
generated your certificates with keytool, you need to convert them.</p>
<ul>
<li><p>use this command to extract the public certificate chain:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">keytool</span> <span class="o">-</span><span class="n">export</span> <span class="o">-</span><span class="n">keystore</span> <span class="n">client</span><span class="o">.</span><span class="n">keystore</span> <span class="o">-</span><span class="n">alias</span> <span class="n">client</span> <span class="o">-</span><span class="n">rfc</span> <span class="o">-</span><span class="n">file</span> <span class="n">client</span><span class="o">.</span><span class="n">crt</span>
</pre></div>
</div>
</li>
<li><p>follow
<a class="reference external" href="http://www.herongyang.com/crypto/Migrating_Keys_keytool_to_OpenSSL_3.html">this tutorial</a>
to extract your client’s private key from <code class="docutils literal notranslate"><span class="pre">client.keystore</span></code> to a text
file <code class="docutils literal notranslate"><span class="pre">client.key</span></code> in PEM format.</p></li>
</ul>
</div>
<div class="section" id="updating-your-dependencies">
<h4>Updating your dependencies<a class="headerlink" href="#updating-your-dependencies" title="Permalink to this headline">¶</a></h4>
<p>Netty-tcnative provides the native integration with OpenSSL. Follow
<a class="reference external" href="http://netty.io/wiki/forked-tomcat-native.html">these instructions</a> to
add it to your dependencies.</p>
<p>There are known runtime incompatibilities between newer versions of
netty-tcnative and the version of netty that the driver uses.  For best
results, use version 2.0.7.Final.</p>
<p>Using netty-tcnative requires JDK 1.7 or above and requires the presence of
OpenSSL on the system.  It will not fall back to the JDK implementation.</p>
</div>
<div class="section" id="configuring-the-context">
<h4>Configuring the context<a class="headerlink" href="#configuring-the-context" title="Permalink to this headline">¶</a></h4>
<p>Use the following Java code to configure OpenSSL with your certificates:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">KeyStore</span> <span class="n">ks</span> <span class="o">=</span> <span class="n">KeyStore</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&quot;JKS&quot;</span><span class="o">);</span>
<span class="c1">// make sure you close this stream properly (not shown here for brevity)</span>
<span class="n">InputStream</span> <span class="n">trustStore</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="s">&quot;client.truststore&quot;</span><span class="o">);</span>
<span class="n">ks</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">trustStore</span><span class="o">,</span> <span class="s">&quot;password123&quot;</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">());</span>
<span class="n">TrustManagerFactory</span> <span class="n">tmf</span> <span class="o">=</span> <span class="n">TrustManagerFactory</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">TrustManagerFactory</span><span class="o">.</span><span class="na">getDefaultAlgorithm</span><span class="o">());</span>
<span class="n">tmf</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">ks</span><span class="o">);</span>

<span class="n">SslContextBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">SslContextBuilder</span>
  <span class="o">.</span><span class="na">forClient</span><span class="o">()</span>
  <span class="o">.</span><span class="na">sslProvider</span><span class="o">(</span><span class="n">SslProvider</span><span class="o">.</span><span class="na">OPENSSL</span><span class="o">)</span>
  <span class="o">.</span><span class="na">trustManager</span><span class="o">(</span><span class="n">tmf</span><span class="o">);</span>
  <span class="c1">// only if you use client authentication</span>
  <span class="o">.</span><span class="na">keyManager</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">&quot;client.crt&quot;</span><span class="o">),</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">&quot;client.key&quot;</span><span class="o">));</span>

<span class="n">SSLOptions</span> <span class="n">sslOptions</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RemoteEndpointAwareNettySSLOptions</span><span class="o">(</span><span class="n">builder</span><span class="o">.</span><span class="na">build</span><span class="o">());</span>

<span class="n">Cluster</span> <span class="n">cluster</span> <span class="o">=</span> <span class="n">Cluster</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
  <span class="o">.</span><span class="na">addContactPoint</span><span class="o">(</span><span class="s">&quot;127.0.0.1&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="na">withSSL</span><span class="o">(</span><span class="n">sslOptions</span><span class="o">)</span>
  <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
  <div class="content-navigation">
  <div class="navigation navigation--prev">
    <a class="navigation__link" href="../speculative_execution/index.html">
      <button class="navigation__button">
        <i class="scylla-icon scylla-icon--chevron-left"></i>
      </button>
      <div class="navigation__title">
        <span class="colored">PREVIOUS</span> <br />Speculative query execution
      </div>
    </a>
  </div>
  <div class="navigation navigation--next">
    <a class="navigation__link" href="../statements/index.html">
      <div class="navigation__title">
        <span class="colored">NEXT</span> <br />Statements
      </div>
      <button class="navigation__button">
        <i class="scylla-icon scylla-icon--chevron-right"></i>
      </button>
    </a>
  </div>
</div> 
      </div>
      <div
        class="sidebar-left  large-order-1"
      > <div id="side-nav" class="side-nav custom-scroll-bar" data-closable data-toggler=".show">
  <button class="collapsible-button">
    <i class="scylla-icon scylla-icon--chevron-left"></i>
  </button>
  <div class="side-nav-content">
    <div class="side-nav__search">
      <div class="search-box">
        <ci-search></ci-search>
      </div>
    </div>
    <div class="side-nav__versions">
       <ul
  class="dropdown menu scylla-dropdown scylla-dropdown--versions "
  data-dropdown-menu
>
  <li class="scylla-dropdown__item">
    <a class="scylla-dropdown__title" href="#">
       3.10.2.x 
      <i class="chevron scylla-icon scylla-icon--chevron-right"></i>
    </a>
    <ul class="menu scylla-dropdown__content"> 
      <li>
        <a href="../../../scylla-3.7.2.x/index.html"
          >3.7.2.x</a
        >
      </li>
       
      <li>
        <a href="index.html"
          >3.10.2.x</a
        >
      </li>
       
    </ul>
  </li>
</ul> 
    </div>
    <div class="side-nav__content">
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Scylla Java Driver for Scylla and Apache Cassandra®</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Documentation</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Manual</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../address_resolution/index.html">Address resolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../async/index.html">Asynchronous programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auth/index.html">Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../compression/index.html">Compression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../control_connection/index.html">Control connection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../custom_codecs/index.html">Custom Codecs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../custom_payloads/index.html">Custom Payloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../idempotence/index.html">Query idempotence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../load_balancing/index.html">Load balancing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging/index.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metadata/index.html">Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/index.html">Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../native_protocol/index.html">Native protocol</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../object_mapper/index.html">Object Mapper</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../object_mapper/creating/index.html">Definition of mapped classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../object_mapper/custom_codecs/index.html">Using custom codecs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../object_mapper/using/index.html">Using the mapper</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../osgi/index.html">OSGi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../paging/index.html">Paging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pooling/index.html">Connection pooling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../query_timestamps/index.html">Query timestamps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reconnection/index.html">Reconnection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../retries/index.html">Retries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shaded_jar/index.html">Using the shaded JAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../socket_options/index.html">Socket options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../speculative_execution/index.html">Speculative query execution</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">SSL</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../statements/index.html">Statements</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../statements/simple/index.html">Simple statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statements/prepared/index.html">Prepared statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statements/built/index.html">Built statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statements/batch/index.html">Batch statements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tuples/index.html">Using Tuples with the Java driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../udts/index.html">User-defined types</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../upgrade_guide/index.html">Upgrade guide</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../upgrade_guide/migrating_from_astyanax/index.html">Migrating from Astyanax</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label for="toctree-checkbox-5"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../upgrade_guide/migrating_from_astyanax/configuration/index.html">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../upgrade_guide/migrating_from_astyanax/language_level_changes/index.html">Language change : from Thrift to CQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../upgrade_guide/migrating_from_astyanax/queries_and_results/index.html">Queries and Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog/index.html">Changelog</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
      
      <div class="sidebar-right large-order-3">
         <div class="secondary-side-nav custom-scroll-bar">
  <div class="secondary-side-nav__content">
    <p class="topic-title">On this page</p>
    <ul>
<li><a class="reference internal" href="#">SSL</a><ul>
<li><a class="reference internal" href="#preparing-the-certificates">Preparing the certificates</a><ul>
<li><a class="reference internal" href="#client-truststore">Client truststore</a></li>
<li><a class="reference internal" href="#client-keystore">Client keystore</a></li>
</ul>
</li>
<li><a class="reference internal" href="#driver-configuration">Driver configuration</a><ul>
<li><a class="reference internal" href="#jsse-property-based">JSSE, Property-based</a></li>
<li><a class="reference internal" href="#jsse-programmatic">JSSE, programmatic</a></li>
<li><a class="reference internal" href="#netty">Netty</a><ul>
<li><a class="reference internal" href="#converting-your-client-certificates-for-openssl">Converting your client certificates for OpenSSL</a></li>
<li><a class="reference internal" href="#updating-your-dependencies">Updating your dependencies</a></li>
<li><a class="reference internal" href="#configuring-the-context">Configuring the context</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
</div> 
      </div>
    </section>

    <footer class="footer">
  <div class="footer-group">
    <div class="footer-top">
      <a class="footer-logo" href="https://www.scylladb.com"
        ><img
          src="../../_static/img/logo-scylla-horizontal-RGB.svg"
          alt="Logo"
      /></a>
      <div class="footer-links">
        <a class="footer-links__link" href="https://docs.scylladb.com/">Docs</a>
        <a
          class="footer-links__link"
          href="https://www.scylladb.com/company/contact-us/"
          >Contact Us</a
        >
        <a class="footer-links__link" href="https://www.scylladb.com/company/"
          >About Us</a
        >
      </div>
      <div class="footer-actions">
        <a
          class="footer-actions__link"
          href="https://groups.google.com/g/scylladb-users"
          target="_blank"
          ><span
            data-tooltip
            tabindex="1"
            title="User mailing list"
            data-position="bottom"
          >
            <img
              src="../../_static/img/icons/icon-mail-list.svg"
              alt="Mail List Icon"
            />
          </span>
        </a>
        <a
          class="footer-actions__link"
          href="http://slack.scylladb.com/"
          target="_blank"
          ><span
            data-tooltip
            tabindex="1"
            title="User Slack channel"
            data-position="bottom"
          >
            <img
              src="../../_static/img/icons/icon-slack.svg"
              alt="Slack Icon"
          /></span>
        </a>
      </div>
    </div>

    <div class="footer-bottom">
      <div class="footer-bottom__copyright"> &#169; 2022, ScyllaDB. All rights reserved.
      </div>
      <div class="footer-bottom__last-updated">
        Last updated on 07 February 2022.
      </div>
      <div class="footer-bottom__version">
        Powered by
        <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a> &amp;
        <a href="https://sphinx-theme.scylladb.com/"
          >ScyllaDB Theme 1.0.6</a
        >
      </div>
    </div>
  </div>
</footer>

    <noscript>
      <iframe
        src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP"
        height="0"
        width="0"
        style="display: none; visibility: hidden"
      ></iframe>
    </noscript>
  </body>
</html>